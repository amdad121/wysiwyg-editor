<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WYSIWYG Editor - VUEJS</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100">
    <div class="max-w-sm mx-auto m-4 space-y-4" id="app">
        <div class="p-4 shadow rounded bg-white space-y-1">
            <div>
                <button class="border bg-white px-2 py-1 rounded-sm" @click="toggleFormatting('bold')">
                    <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#212121"
                        gradientcolor1="#212121" gradientcolor2="#212121">
                        <path
                            d="M6.935 4.44A1.5 1.5 0 0 1 7.996 4h4.383C15.017 4 17 6.182 17 8.625c0 .977-.316 1.912-.865 2.682 1.077.827 1.866 2.12 1.866 3.813C18 18.232 15.3 20 13.12 20H8a1.5 1.5 0 0 1-1.5-1.5l-.004-13c0-.397.158-.779.44-1.06ZM9.5 10.25h2.88c.903 0 1.62-.76 1.62-1.625S13.281 7 12.38 7H9.498l.002 3.25Zm0 3V17h3.62c.874 0 1.88-.753 1.88-1.88 0-1.13-.974-1.87-1.88-1.87H9.5Z">
                        </path>
                    </svg>
                </button>
                <button class="border bg-white px-2 py-1 rounded-sm" @click="toggleFormatting('italic')">
                    <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#212121"
                        gradientcolor1="#212121" gradientcolor2="#212121">
                        <path
                            d="M9.75 4h8.504a.75.75 0 0 1 .102 1.493l-.102.006h-3.197L10.037 18.5h4.213a.75.75 0 0 1 .742.648l.007.102a.75.75 0 0 1-.648.743L14.25 20h-9.5a.747.747 0 0 1-.746-.75c0-.38.28-.694.645-.743l.101-.007h3.685l.021-.065L13.45 5.499h-3.7a.75.75 0 0 1-.742-.648L9 4.75a.75.75 0 0 1 .648-.743L9.751 4h8.503-8.503Z">
                        </path>
                    </svg>
                </button>
                <button class="border bg-white px-2 py-1 rounded-sm" @click="toggleFormatting('strike')">
                    <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#212121"
                        gradientcolor1="#212121" gradientcolor2="#212121">
                        <path
                            d="M4.75 12h14.5a.75.75 0 0 1 .102 1.493l-.101.007h-2.975c.88.813 1.336 1.793 1.336 2.935 0 2.825-3.232 4.64-6.754 4.23-2.235-.26-3.809-1.155-4.635-2.702a.75.75 0 0 1 1.323-.707c.57 1.068 1.702 1.712 3.485 1.92 2.743.318 5.081-.995 5.081-2.741 0-1.172-.805-2.127-2.565-2.886l-.116-.049H4.75a.75.75 0 0 1-.743-.648L4 12.75a.75.75 0 0 1 .648-.743L4.75 12h14.5-14.5Zm1.511-3.877c.152-2.83 2.822-4.468 6.324-4.061 2.188.254 3.863 1.053 4.982 2.409a.75.75 0 1 1-1.157.955c-.852-1.033-2.17-1.662-3.999-1.874-2.717-.316-4.65.805-4.65 2.571 0 .772.234 1.349.83 1.982l.128.132c.094.096.197.195.25.24l.031.02H7.08l-.024-.038c-.143-.206-.856-1.195-.795-2.336Z">
                        </path>
                    </svg>
                </button>
                <button class="border bg-white px-2 py-1 rounded-sm" @click="toggleFormatting('code')">
                    <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#212121"
                        gradientcolor1="#212121" gradientcolor2="#212121">
                        <path
                            d="m8.066 18.943 6.5-14.5a.75.75 0 0 1 1.404.518l-.036.096-6.5 14.5a.75.75 0 0 1-1.404-.518l.036-.096 6.5-14.5-6.5 14.5ZM2.22 11.47l4.25-4.25a.75.75 0 0 1 1.133.976l-.073.084L3.81 12l3.72 3.72a.75.75 0 0 1-.976 1.133l-.084-.073-4.25-4.25a.75.75 0 0 1-.073-.976l.073-.084 4.25-4.25-4.25 4.25Zm14.25-4.25a.75.75 0 0 1 .976-.073l.084.073 4.25 4.25a.75.75 0 0 1 .073.976l-.073.084-4.25 4.25a.75.75 0 0 1-1.133-.976l.073-.084L20.19 12l-3.72-3.72a.75.75 0 0 1 0-1.06Z">
                        </path>
                    </svg>
                </button>
                <button class="border bg-white px-2 py-1 rounded-sm" @click="insertLink">
                    <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#212121"
                        gradientcolor1="#212121" gradientcolor2="#212121">
                        <path fill="url(#Link_svg__a)"
                            d="M9.25 7a.75.75 0 0 1 .11 1.492l-.11.008H7a3.5 3.5 0 0 0-.206 6.994L7 15.5h2.25a.75.75 0 0 1 .11 1.492L9.25 17H7a5 5 0 0 1-.25-9.994L7 7h2.25ZM17 7a5 5 0 0 1 .25 9.994L17 17h-2.25a.75.75 0 0 1-.11-1.492l.11-.008H17a3.5 3.5 0 0 0 .206-6.994L17 8.5h-2.25a.75.75 0 0 1-.11-1.492L14.75 7H17ZM7 11.25h10a.75.75 0 0 1 .102 1.493L17 12.75H7a.75.75 0 0 1-.102-1.493L7 11.25h10H7Z">
                        </path>
                        <defs>
                            <linearGradient id="Link_svg__a" x1="2" y1="2" x2="23.5" y2="22"
                                gradientUnits="userSpaceOnUse">
                                <stop stop-color="#212121"></stop>
                                <stop offset="1" stop-color="#212121"></stop>
                            </linearGradient>
                        </defs>
                    </svg>
                </button>
            </div>
            <div>
                <textarea class="border w-full focus:outline-none px-2 py-1 h-24 rounded-sm" v-model="content"
                    @input="updatePreview"></textarea>
            </div>
        </div>
        <div class="p-4 shadow rounded bg-white" v-if="content.length">
            <h3 class="-mt-2 border-b pb-1 mb-2">Preview</h3>
            <div id="preview"></div>
        </div>
        <p class="text-center text-sm font-semibold text-gray-700">
          Made with
          <svg class="inline size-4 text-red-500" xmlns="http://www.w3.org/2000/svg" fill="red" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z"></path>
          </svg>
          by
          <a class="hover:underline" href="https://amdadulhaq.com" target="_blank" rel="noopener noreferrer">Amdadul Haq</a>
      </p>
    </div>

    <script type="module">
        import {
            createApp,
            ref,
        } from 'https://unpkg.com/vue@3/dist/vue.esm-browser.js';
        createApp({
            setup() {
                const content = ref('');

                const toggleFormatting = (type) => {
                    let openTag = '', closeTag = '';

                    switch (type) {
                        case 'bold':
                            openTag = '**';
                            closeTag = '**';
                            break;
                        case 'italic':
                            openTag = '_';
                            closeTag = '_';
                            break;
                        case 'strike':
                            openTag = '~';
                            closeTag = '~';
                            break;
                        case 'code':
                            openTag = '`';
                            closeTag = '`';
                            break;
                        default:
                            openTag = '';
                            closeTag = '';
                    }

                    modifySelectionText(openTag, closeTag);
                };

                const modifySelectionText = (openTag, closeTag) => {
                    const textarea = document.querySelector('textarea');
                    const selectedText = textarea.value.substring(textarea.selectionStart, textarea.selectionEnd);

                    if (selectedText) {
                        const textBeforeSelection = textarea.value.substring(0, textarea.selectionStart);
                        const textAfterSelection = textarea.value.substring(textarea.selectionEnd);

                        const isTagAlreadyApplied = textBeforeSelection.endsWith(openTag) && textAfterSelection.startsWith(closeTag);

                        if (isTagAlreadyApplied) {
                            const newText = textBeforeSelection.slice(0, -openTag.length) + selectedText + textAfterSelection.slice(closeTag.length);
                            textarea.value = newText;
                            textarea.selectionStart = textBeforeSelection.length - openTag.length;
                            textarea.selectionEnd = textarea.selectionStart + selectedText.length;
                        } else {
                            const modifiedText = openTag + selectedText + closeTag;
                            const newText = textBeforeSelection + modifiedText + textAfterSelection;

                            textarea.value = newText;

                            textarea.selectionStart = textBeforeSelection.length + openTag.length;
                            textarea.selectionEnd = textarea.selectionStart + selectedText.length;
                        }
                    } else {
                        const cursorPos = textarea.selectionStart;
                        const textBeforeCursor = textarea.value.substring(0, cursorPos);
                        const textAfterCursor = textarea.value.substring(cursorPos);

                        if (textBeforeCursor.endsWith(openTag) && textAfterCursor.startsWith(closeTag)) {
                            const newText = textBeforeCursor.slice(0, -openTag.length) + textAfterCursor.slice(closeTag.length);
                            textarea.value = newText;
                            textarea.selectionStart = textBeforeCursor.length - openTag.length;
                            textarea.selectionEnd = textarea.selectionStart;
                        } else {
                            const tag = openTag + closeTag;
                            textarea.value = textBeforeCursor + tag + textAfterCursor;

                            textarea.selectionStart = cursorPos + openTag.length;
                            textarea.selectionEnd = cursorPos + openTag.length;
                        }
                    }

                    textarea.focus();

                    updatePreview();
                };

                const insertLink = () => {
                    const url = prompt('Enter the URL:');
                    const textarea = document.querySelector('textarea');
                    if (url) {
                        const selectedText = textarea.value.substring(textarea.selectionStart, textarea.selectionEnd);
                        const link = `[${selectedText}](${url})`;

                        if (selectedText) {
                            const textBeforeSelection = textarea.value.substring(0, textarea.selectionStart);
                            const textAfterSelection = textarea.value.substring(textarea.selectionEnd);

                            const newText = textBeforeSelection + link + textAfterSelection;

                            textarea.value = newText;
                            textarea.focus();
                            textarea.selectionStart = textBeforeSelection.length + 1;
                            textarea.selectionEnd = textBeforeSelection.length + 1 + selectedText.length;
                        } else {
                            const textBeforeCursor = textarea.value.substring(0, textarea.selectionStart);
                            const textAfterCursor = textarea.value.substring(textarea.selectionEnd);

                            const newText = textBeforeCursor + '[' + ']' + '(' + url + ')' + textAfterCursor;

                            textarea.value = newText;
                            textarea.focus();
                            textarea.selectionStart = textBeforeCursor.length + 1;
                            textarea.selectionEnd = textBeforeCursor.length + 1;
                        }
                    }

                    textarea.focus();

                    updatePreview();
                };

                const updatePreview = () => {
                    let previewText = document.querySelector('textarea').value;
                    const preview = document.getElementById('preview');

                    previewText = previewText.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
                    previewText = previewText.replace(/_(.*?)_/g, '<em>$1</em>');
                    previewText = previewText.replace(/~(.*?)~/g, '<del>$1</del>');
                    previewText = previewText.replace(/`(.*?)`/g, '<code>$1</code>');
                    previewText = previewText.replace(/\[(.*?)\]\((.*?)\)/g, '<a href="$2">$1</a>');

                    if (preview) {
                        preview.innerHTML = previewText;
                    }
                };

                return {
                    content,
                    toggleFormatting,
                    insertLink,
                    updatePreview,
                };
            },
        }).mount('#app');
    </script>
</body>

</html>